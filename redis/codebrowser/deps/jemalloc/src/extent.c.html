<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>extent.c source code [codebrowser/deps/jemalloc/src/extent.c] - Woboq Code Browser</title>
<link rel="stylesheet" href="../../../../../data/qtcreator.css" title="QtCreator"/>
<link rel="alternate stylesheet" href="../../../../../data/kdevelop.css" title="KDevelop"/>
<script type="text/javascript" src="../../../../../data/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../../../../../data/jquery/jquery-ui.min.js"></script>
<script>var file = 'codebrowser/deps/jemalloc/src/extent.c'; var root_path = '../../../..'; var data_path = '../../../../../data';</script>
<script src='../../../../../data/codebrowser.js'></script>
</head>
<body><div id='header'><h1 id='breadcrumb'><span>Browse the source code of </span><a href='../../..'>codebrowser</a>/<a href='../..'>deps</a>/<a href='..'>jemalloc</a>/<a href='./'>src</a>/<a href='extent.c.html'>extent.c</a></h1></div>
<hr/><div id='content'><table class="code">
<tr><th id="1">1</th><td><u>#define	<dfn class="macro" id="_M/JEMALLOC_EXTENT_C_" data-ref="_M/JEMALLOC_EXTENT_C_">JEMALLOC_EXTENT_C_</dfn></u></td></tr>
<tr><th id="2">2</th><td><u>#include <a href="../include/jemalloc/internal/jemalloc_internal.h.html">"jemalloc/internal/jemalloc_internal.h"</a></u></td></tr>
<tr><th id="3">3</th><td></td></tr>
<tr><th id="4">4</th><td><i>/******************************************************************************/</i></td></tr>
<tr><th id="5">5</th><td></td></tr>
<tr><th id="6">6</th><td><a class="macro" href="../include/jemalloc/internal/jemalloc_internal_macros.h.html#29" title="static inline" data-ref="_M/JEMALLOC_INLINE_C">JEMALLOC_INLINE_C</a> <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t">size_t</span></td></tr>
<tr><th id="7">7</th><td><dfn class="decl def" id="extent_quantize" title='extent_quantize' data-ref="extent_quantize">extent_quantize</dfn>(<span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t">size_t</span> <dfn class="local col1 decl" id="1size" title='size' data-type='size_t' data-ref="1size">size</dfn>)</td></tr>
<tr><th id="8">8</th><td>{</td></tr>
<tr><th id="9">9</th><td></td></tr>
<tr><th id="10">10</th><td>	<i>/*</i></td></tr>
<tr><th id="11">11</th><td><i>	 * Round down to the nearest chunk size that can actually be requested</i></td></tr>
<tr><th id="12">12</th><td><i>	 * during normal huge allocation.</i></td></tr>
<tr><th id="13">13</th><td><i>	 */</i></td></tr>
<tr><th id="14">14</th><td>	<b>return</b> (<a class="macro" href="../include/jemalloc/internal/private_namespace.h.html#268" title="je_index2size" data-ref="_M/index2size">index2size</a>(<a class="macro" href="../include/jemalloc/internal/private_namespace.h.html#421" title="je_size2index" data-ref="_M/size2index">size2index</a>(<a class="local col1 ref" href="#1size" title='size' data-ref="1size">size</a> + <var>1</var>) - <var>1</var>));</td></tr>
<tr><th id="15">15</th><td>}</td></tr>
<tr><th id="16">16</th><td></td></tr>
<tr><th id="17">17</th><td><a class="macro" href="../include/jemalloc/internal/jemalloc_internal_macros.h.html#29" title="static inline" data-ref="_M/JEMALLOC_INLINE_C">JEMALLOC_INLINE_C</a> <em>int</em></td></tr>
<tr><th id="18">18</th><td><dfn class="decl def" id="extent_szad_comp" title='extent_szad_comp' data-ref="extent_szad_comp">extent_szad_comp</dfn>(<a class="typedef" href="../include/jemalloc/internal/extent.h.html#extent_node_t" title='extent_node_t' data-type='struct extent_node_s' data-ref="extent_node_t">extent_node_t</a> *<dfn class="local col2 decl" id="2a" title='a' data-type='extent_node_t *' data-ref="2a">a</dfn>, <a class="typedef" href="../include/jemalloc/internal/extent.h.html#extent_node_t" title='extent_node_t' data-type='struct extent_node_s' data-ref="extent_node_t">extent_node_t</a> *<dfn class="local col3 decl" id="3b" title='b' data-type='extent_node_t *' data-ref="3b">b</dfn>)</td></tr>
<tr><th id="19">19</th><td>{</td></tr>
<tr><th id="20">20</th><td>	<em>int</em> <dfn class="local col4 decl" id="4ret" title='ret' data-type='int' data-ref="4ret">ret</dfn>;</td></tr>
<tr><th id="21">21</th><td>	<span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t">size_t</span> <dfn class="local col5 decl" id="5a_qsize" title='a_qsize' data-type='size_t' data-ref="5a_qsize">a_qsize</dfn> = <a class="ref" href="#extent_quantize" title='extent_quantize' data-ref="extent_quantize">extent_quantize</a>(<a class="macro" href="../include/jemalloc/internal/private_namespace.h.html#199" title="je_extent_node_size_get" data-ref="_M/extent_node_size_get">extent_node_size_get</a>(<a class="local col2 ref" href="#2a" title='a' data-ref="2a">a</a>));</td></tr>
<tr><th id="22">22</th><td>	<span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t">size_t</span> <dfn class="local col6 decl" id="6b_qsize" title='b_qsize' data-type='size_t' data-ref="6b_qsize">b_qsize</dfn> = <a class="ref" href="#extent_quantize" title='extent_quantize' data-ref="extent_quantize">extent_quantize</a>(<a class="macro" href="../include/jemalloc/internal/private_namespace.h.html#199" title="je_extent_node_size_get" data-ref="_M/extent_node_size_get">extent_node_size_get</a>(<a class="local col3 ref" href="#3b" title='b' data-ref="3b">b</a>));</td></tr>
<tr><th id="23">23</th><td></td></tr>
<tr><th id="24">24</th><td>	<i>/*</i></td></tr>
<tr><th id="25">25</th><td><i>	 * Compare based on quantized size rather than size, in order to sort</i></td></tr>
<tr><th id="26">26</th><td><i>	 * equally useful extents only by address.</i></td></tr>
<tr><th id="27">27</th><td><i>	 */</i></td></tr>
<tr><th id="28">28</th><td>	<a class="local col4 ref" href="#4ret" title='ret' data-ref="4ret">ret</a> = (<a class="local col5 ref" href="#5a_qsize" title='a_qsize' data-ref="5a_qsize">a_qsize</a> &gt; <a class="local col6 ref" href="#6b_qsize" title='b_qsize' data-ref="6b_qsize">b_qsize</a>) - (<a class="local col5 ref" href="#5a_qsize" title='a_qsize' data-ref="5a_qsize">a_qsize</a> &lt; <a class="local col6 ref" href="#6b_qsize" title='b_qsize' data-ref="6b_qsize">b_qsize</a>);</td></tr>
<tr><th id="29">29</th><td>	<b>if</b> (<a class="local col4 ref" href="#4ret" title='ret' data-ref="4ret">ret</a> == <var>0</var>) {</td></tr>
<tr><th id="30">30</th><td>		<a class="typedef" href="../../../../include/stdint.h.html#uintptr_t" title='uintptr_t' data-type='unsigned long' data-ref="uintptr_t">uintptr_t</a> <dfn class="local col7 decl" id="7a_addr" title='a_addr' data-type='uintptr_t' data-ref="7a_addr">a_addr</dfn> = (<a class="typedef" href="../../../../include/stdint.h.html#uintptr_t" title='uintptr_t' data-type='unsigned long' data-ref="uintptr_t">uintptr_t</a>)<a class="macro" href="../include/jemalloc/internal/private_namespace.h.html#189" title="je_extent_node_addr_get" data-ref="_M/extent_node_addr_get">extent_node_addr_get</a>(<a class="local col2 ref" href="#2a" title='a' data-ref="2a">a</a>);</td></tr>
<tr><th id="31">31</th><td>		<a class="typedef" href="../../../../include/stdint.h.html#uintptr_t" title='uintptr_t' data-type='unsigned long' data-ref="uintptr_t">uintptr_t</a> <dfn class="local col8 decl" id="8b_addr" title='b_addr' data-type='uintptr_t' data-ref="8b_addr">b_addr</dfn> = (<a class="typedef" href="../../../../include/stdint.h.html#uintptr_t" title='uintptr_t' data-type='unsigned long' data-ref="uintptr_t">uintptr_t</a>)<a class="macro" href="../include/jemalloc/internal/private_namespace.h.html#189" title="je_extent_node_addr_get" data-ref="_M/extent_node_addr_get">extent_node_addr_get</a>(<a class="local col3 ref" href="#3b" title='b' data-ref="3b">b</a>);</td></tr>
<tr><th id="32">32</th><td></td></tr>
<tr><th id="33">33</th><td>		<a class="local col4 ref" href="#4ret" title='ret' data-ref="4ret">ret</a> = (<a class="local col7 ref" href="#7a_addr" title='a_addr' data-ref="7a_addr">a_addr</a> &gt; <a class="local col8 ref" href="#8b_addr" title='b_addr' data-ref="8b_addr">b_addr</a>) - (<a class="local col7 ref" href="#7a_addr" title='a_addr' data-ref="7a_addr">a_addr</a> &lt; <a class="local col8 ref" href="#8b_addr" title='b_addr' data-ref="8b_addr">b_addr</a>);</td></tr>
<tr><th id="34">34</th><td>	}</td></tr>
<tr><th id="35">35</th><td></td></tr>
<tr><th id="36">36</th><td>	<b>return</b> (<a class="local col4 ref" href="#4ret" title='ret' data-ref="4ret">ret</a>);</td></tr>
<tr><th id="37">37</th><td>}</td></tr>
<tr><th id="38">38</th><td></td></tr>
<tr><th id="39">39</th><td><i>/* Generate red-black tree functions. */</i></td></tr>
<tr><th id="40">40</th><td><a class="macro" href="../include/jemalloc/internal/rb.h.html#316" title="void je_extent_tree_szad_new(extent_tree_t *rbtree) { do { (rbtree)-&gt;rbt_root = &amp;(rbtree)-&gt;rbt_nil; do { do { ((&amp;(rbtree)-&gt;rbt_nil))-&gt;szad_link.rbn_left = &amp;(rbtree)-&gt;rbt_nil; } while (0); do { ((&amp;(rbtree)-&gt;rbt_nil))-&gt;szad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) &amp;(rbtree)-&gt;rbt_nil) | (((uintptr_t) ((&amp;(rbtree)-&gt;rbt_nil))-&gt;szad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); do { ((&amp;(rbtree)-&gt;rbt_nil))-&gt;szad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) ((&amp;(rbtree)-&gt;rbt_nil))-&gt;szad_link.rbn_right_red) | ((size_t)1)); } while (0); } while (0); do { (&amp;(rbtree)-&gt;rbt_nil)-&gt;szad_link.rbn_right_red = (extent_node_t *) (((intptr_t) (&amp;(rbtree)-&gt;rbt_nil)-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2)); } while (0); } while (0); } _Bool je_extent_tree_szad_empty(extent_tree_t *rbtree) { return (rbtree-&gt;rbt_root == &amp;rbtree-&gt;rbt_nil); } extent_node_t * je_extent_tree_szad_first(extent_tree_t *rbtree) { extent_node_t *ret; do { (ret) = (rbtree-&gt;rbt_root); if ((ret) != &amp;(rbtree)-&gt;rbt_nil) { for (; (((ret))-&gt;szad_link.rbn_left) != &amp;(rbtree)-&gt;rbt_nil; (ret) = (((ret))-&gt;szad_link.rbn_left)) { } } } while (0); if (ret == &amp;rbtree-&gt;rbt_nil) { ret = ((void*)0); } return (ret); } extent_node_t * je_extent_tree_szad_last(extent_tree_t *rbtree) { extent_node_t *ret; do { (ret) = (rbtree-&gt;rbt_root); if ((ret) != &amp;(rbtree)-&gt;rbt_nil) { for (; ((extent_node_t *) (((intptr_t) ((ret))-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2))) != &amp;(rbtree)-&gt;rbt_nil; (ret) = ((extent_node_t *) (((intptr_t) ((ret))-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2)))) { } } } while (0); if (ret == &amp;rbtree-&gt;rbt_nil) { ret = ((void*)0); } return (ret); } extent_node_t * je_extent_tree_szad_next(extent_tree_t *rbtree, extent_node_t *node) { extent_node_t *ret; if (((extent_node_t *) (((intptr_t) (node)-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2))) != &amp;rbtree-&gt;rbt_nil) { do { (ret) = (((extent_node_t *) (((intptr_t) (node)-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2)))); if ((ret) != &amp;(rbtree)-&gt;rbt_nil) { for (; (((ret))-&gt;szad_link.rbn_left) != &amp;(rbtree)-&gt;rbt_nil; (ret) = (((ret))-&gt;szad_link.rbn_left)) { } } } while (0); } else { extent_node_t *tnode = rbtree-&gt;rbt_root; do { if (__builtin_expect(!!(config_debug &amp;&amp; !(tnode != &amp;rbtree-&gt;rbt_nil)), 0)) { je_malloc_printf( &quot;&lt;jemalloc&gt;: %s:%d: Failed assertion: \&quot;%s\&quot;\n&quot;, &quot;/home/jon/workspace/redis/deps/jemalloc/src/extent.c&quot;, 41, &quot;tnode != &amp;rbtree-&gt;rbt_nil&quot;); abort(); } } while (0); ret = &amp;rbtree-&gt;rbt_nil; while (1) { int cmp = (extent_szad_comp)(node, tnode); if (cmp &lt; 0) { ret = tnode; tnode = ((tnode)-&gt;szad_link.rbn_left); } else if (cmp &gt; 0) { tnode = ((extent_node_t *) (((intptr_t) (tnode)-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2))); } else { break; } do { if (__builtin_expect(!!(config_debug &amp;&amp; !(tnode != &amp;rbtree-&gt;rbt_nil)), 0)) { je_malloc_printf( &quot;&lt;jemalloc&gt;: %s:%d: Failed assertion: \&quot;%s\&quot;\n&quot;, &quot;/home/jon/workspace/redis/deps/jemalloc/src/extent.c&quot;, 41, &quot;tnode != &amp;rbtree-&gt;rbt_nil&quot;); abort(); } } while (0); } } if (ret == &amp;rbtree-&gt;rbt_nil) { ret = (((void*)0)); } return (ret); } extent_node_t * je_extent_tree_szad_prev(extent_tree_t *rbtree, extent_node_t *node) { extent_node_t *ret; if (((node)-&gt;szad_link.rbn_left) != &amp;rbtree-&gt;rbt_nil) { do { (ret) = (((node)-&gt;szad_link.rbn_left)); if ((ret) != &amp;(rbtree)-&gt;rbt_nil) { for (; ((extent_node_t *) (((intptr_t) ((ret))-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2))) != &amp;(rbtree)-&gt;rbt_nil; (ret) = ((extent_node_t *) (((intptr_t) ((ret))-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2)))) { } } } while (0); } else { extent_node_t *tnode = rbtree-&gt;rbt_root; do { if (__builtin_expect(!!(config_debug &amp;&amp; !(tnode != &amp;rbtree-&gt;rbt_nil)), 0)) { je_malloc_printf( &quot;&lt;jemalloc&gt;: %s:%d: Failed assertion: \&quot;%s\&quot;\n&quot;, &quot;/home/jon/workspace/redis/deps/jemalloc/src/extent.c&quot;, 41, &quot;tnode != &amp;rbtree-&gt;rbt_nil&quot;); abort(); } } while (0); ret = &amp;rbtree-&gt;rbt_nil; while (1) { int cmp = (extent_szad_comp)(node, tnode); if (cmp &lt; 0) { tnode = ((tnode)-&gt;szad_link.rbn_left); } else if (cmp &gt; 0) { ret = tnode; tnode = ((extent_node_t *) (((intptr_t) (tnode)-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2))); } else { break; } do { if (__builtin_expect(!!(config_debug &amp;&amp; !(tnode != &amp;rbtree-&gt;rbt_nil)), 0)) { je_malloc_printf( &quot;&lt;jemalloc&gt;: %s:%d: Failed assertion: \&quot;%s\&quot;\n&quot;, &quot;/home/jon/workspace/redis/deps/jemalloc/src/extent.c&quot;, 41, &quot;tnode != &amp;rbtree-&gt;rbt_nil&quot;); abort(); } } while (0); } } if (ret == &amp;rbtree-&gt;rbt_nil) { ret = (((void*)0)); } return (ret); } extent_node_t * je_extent_tree_szad_search(extent_tree_t *rbtree, extent_node_t *key) { extent_node_t *ret; int cmp; ret = rbtree-&gt;rbt_root; while (ret != &amp;rbtree-&gt;rbt_nil &amp;&amp; (cmp = (extent_szad_comp)(key, ret)) != 0) { if (cmp &lt; 0) { ret = ((ret)-&gt;szad_link.rbn_left); } else { ret = ((extent_node_t *) (((intptr_t) (ret)-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2))); } } if (ret == &amp;rbtree-&gt;rbt_nil) { ret = (((void*)0)); } return (ret); } extent_node_t * je_extent_tree_szad_nsearch(extent_tree_t *rbtree, extent_node_t *key) { extent_node_t *ret; extent_node_t *tnode = rbtree-&gt;rbt_root; ret = &amp;rbtree-&gt;rbt_nil; while (tnode != &amp;rbtree-&gt;rbt_nil) { int cmp = (extent_szad_comp)(key, tnode); if (cmp &lt; 0) { ret = tnode; tnode = ((tnode)-&gt;szad_link.rbn_left); } else if (cmp &gt; 0) { tnode = ((extent_node_t *) (((intptr_t) (tnode)-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2))); } else { ret = tnode; break; } } if (ret == &amp;rbtree-&gt;rbt_nil) { ret = (((void*)0)); } return (ret); } extent_node_t * je_extent_tree_szad_psearch(extent_tree_t *rbtree, extent_node_t *key) { extent_node_t *ret; extent_node_t *tnode = rbtree-&gt;rbt_root; ret = &amp;rbtree-&gt;rbt_nil; while (tnode != &amp;rbtree-&gt;rbt_nil) { int cmp = (extent_szad_comp)(key, tnode); if (cmp &lt; 0) { tnode = ((tnode)-&gt;szad_link.rbn_left); } else if (cmp &gt; 0) { ret = tnode; tnode = ((extent_node_t *) (((intptr_t) (tnode)-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2))); } else { ret = tnode; break; } } if (ret == &amp;rbtree-&gt;rbt_nil) { ret = (((void*)0)); } return (ret); } void je_extent_tree_szad_insert(extent_tree_t *rbtree, extent_node_t *node) { struct { extent_node_t *node; int cmp; } path[sizeof(void *) &lt;&lt; 4], *pathp; do { do { ((node))-&gt;szad_link.rbn_left = &amp;(rbtree)-&gt;rbt_nil; } while (0); do { ((node))-&gt;szad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) &amp;(rbtree)-&gt;rbt_nil) | (((uintptr_t) ((node))-&gt;szad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); do { ((node))-&gt;szad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) ((node))-&gt;szad_link.rbn_right_red) | ((size_t)1)); } while (0); } while (0); path-&gt;node = rbtree-&gt;rbt_root; for (pathp = path; pathp-&gt;node != &amp;rbtree-&gt;rbt_nil; pathp++) { int cmp = pathp-&gt;cmp = extent_szad_comp(node, pathp-&gt;node); do { if (__builtin_expect(!!(config_debug &amp;&amp; !(cmp != 0)), 0)) { je_malloc_printf( &quot;&lt;jemalloc&gt;: %s:%d: Failed assertion: \&quot;%s\&quot;\n&quot;, &quot;/home/jon/workspace/redis/deps/jemalloc/src/extent.c&quot;, 41, &quot;cmp != 0&quot;); abort(); } } while (0); if (cmp &lt; 0) { pathp[1].node = ((pathp-&gt;node)-&gt;szad_link.rbn_left); } else { pathp[1].node = ((extent_node_t *) (((intptr_t) (pathp-&gt;node)-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2))); } } pathp-&gt;node = node; for (pathp--; (uintptr_t)pathp &gt;= (uintptr_t)path; pathp--) { extent_node_t *cnode = pathp-&gt;node; if (pathp-&gt;cmp &lt; 0) { extent_node_t *left = pathp[1].node; do { (cnode)-&gt;szad_link.rbn_left = left; } while (0); if (((_Bool) (((uintptr_t) (left)-&gt;szad_link.rbn_right_red) &amp; ((size_t)1)))) { extent_node_t *leftleft = ((left)-&gt;szad_link.rbn_left); if (((_Bool) (((uintptr_t) (leftleft)-&gt;szad_link.rbn_right_red) &amp; ((size_t)1)))) { extent_node_t *tnode; do { (leftleft)-&gt;szad_link.rbn_right_red = (extent_node_t *) (((intptr_t) (leftleft)-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2)); } while (0); do { (tnode) = (((cnode))-&gt;szad_link.rbn_left); do { ((cnode))-&gt;szad_link.rbn_left = ((extent_node_t *) (((intptr_t) ((tnode))-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2))); } while (0); do { ((tnode))-&gt;szad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (cnode)) | (((uintptr_t) ((tnode))-&gt;szad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); } while (0); cnode = tnode; } } else { return; } } else { extent_node_t *right = pathp[1].node; do { (cnode)-&gt;szad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) right) | (((uintptr_t) (cnode)-&gt;szad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); if (((_Bool) (((uintptr_t) (right)-&gt;szad_link.rbn_right_red) &amp; ((size_t)1)))) { extent_node_t *left = ((cnode)-&gt;szad_link.rbn_left); if (((_Bool) (((uintptr_t) (left)-&gt;szad_link.rbn_right_red) &amp; ((size_t)1)))) { do { (left)-&gt;szad_link.rbn_right_red = (extent_node_t *) (((intptr_t) (left)-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2)); } while (0); do { (right)-&gt;szad_link.rbn_right_red = (extent_node_t *) (((intptr_t) (right)-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2)); } while (0); do { (cnode)-&gt;szad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (cnode)-&gt;szad_link.rbn_right_red) | ((size_t)1)); } while (0); } else { extent_node_t *tnode; _Bool tred = ((_Bool) (((uintptr_t) (cnode)-&gt;szad_link.rbn_right_red) &amp; ((size_t)1))); do { (tnode) = ((extent_node_t *) (((intptr_t) ((cnode))-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2))); do { ((cnode))-&gt;szad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (((tnode))-&gt;szad_link.rbn_left)) | (((uintptr_t) ((cnode))-&gt;szad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); do { ((tnode))-&gt;szad_link.rbn_left = (cnode); } while (0); } while (0); do { (tnode)-&gt;szad_link.rbn_right_red = (extent_node_t *) ((((intptr_t) (tnode)-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2)) | ((ssize_t)tred)); } while (0); do { (cnode)-&gt;szad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (cnode)-&gt;szad_link.rbn_right_red) | ((size_t)1)); } while (0); cnode = tnode; } } else { return; } } pathp-&gt;node = cnode; } rbtree-&gt;rbt_root = path-&gt;node; do { (rbtree-&gt;rbt_root)-&gt;szad_link.rbn_right_red = (extent_node_t *) (((intptr_t) (rbtree-&gt;rbt_root)-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2)); } while (0); } void je_extent_tree_szad_remove(extent_tree_t *rbtree, extent_node_t *node) { struct { extent_node_t *node; int cmp; } *pathp, *nodep, path[sizeof(void *) &lt;&lt; 4]; nodep = ((void*)0); path-&gt;node = rbtree-&gt;rbt_root; for (pathp = path; pathp-&gt;node != &amp;rbtree-&gt;rbt_nil; pathp++) { int cmp = pathp-&gt;cmp = extent_szad_comp(node, pathp-&gt;node); if (cmp &lt; 0) { pathp[1].node = ((pathp-&gt;node)-&gt;szad_link.rbn_left); } else { pathp[1].node = ((extent_node_t *) (((intptr_t) (pathp-&gt;node)-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2))); if (cmp == 0) { pathp-&gt;cmp = 1; nodep = pathp; for (pathp++; pathp-&gt;node != &amp;rbtree-&gt;rbt_nil; pathp++) { pathp-&gt;cmp = -1; pathp[1].node = ((pathp-&gt;node)-&gt;szad_link.rbn_left); } break; } } } do { if (__builtin_expect(!!(config_debug &amp;&amp; !(nodep-&gt;node == node)), 0)) { je_malloc_printf( &quot;&lt;jemalloc&gt;: %s:%d: Failed assertion: \&quot;%s\&quot;\n&quot;, &quot;/home/jon/workspace/redis/deps/jemalloc/src/extent.c&quot;, 41, &quot;nodep-&gt;node == node&quot;); abort(); } } while (0); pathp--; if (pathp-&gt;node != node) { _Bool tred = ((_Bool) (((uintptr_t) (pathp-&gt;node)-&gt;szad_link.rbn_right_red) &amp; ((size_t)1))); do { (pathp-&gt;node)-&gt;szad_link.rbn_right_red = (extent_node_t *) ((((intptr_t) (pathp-&gt;node)-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2)) | ((ssize_t)((_Bool) (((uintptr_t) (node)-&gt;szad_link.rbn_right_red) &amp; ((size_t)1))))); } while (0); do { (pathp-&gt;node)-&gt;szad_link.rbn_left = ((node)-&gt;szad_link.rbn_left); } while (0); do { (pathp-&gt;node)-&gt;szad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) ((extent_node_t *) (((intptr_t) (node)-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2)))) | (((uintptr_t) (pathp-&gt;node)-&gt;szad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); do { (node)-&gt;szad_link.rbn_right_red = (extent_node_t *) ((((intptr_t) (node)-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2)) | ((ssize_t)tred)); } while (0); nodep-&gt;node = pathp-&gt;node; pathp-&gt;node = node; if (nodep == path) { rbtree-&gt;rbt_root = nodep-&gt;node; } else { if (nodep[-1].cmp &lt; 0) { do { (nodep[-1].node)-&gt;szad_link.rbn_left = nodep-&gt;node; } while (0); } else { do { (nodep[-1].node)-&gt;szad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) nodep-&gt;node) | (((uintptr_t) (nodep[-1].node)-&gt;szad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); } } } else { extent_node_t *left = ((node)-&gt;szad_link.rbn_left); if (left != &amp;rbtree-&gt;rbt_nil) { do { if (__builtin_expect(!!(config_debug &amp;&amp; !(!((_Bool) (((uintptr_t) (node)-&gt;szad_link.rbn_right_red) &amp; ((size_t)1))))), 0)) { je_malloc_printf( &quot;&lt;jemalloc&gt;: %s:%d: Failed assertion: \&quot;%s\&quot;\n&quot;, &quot;/home/jon/workspace/redis/deps/jemalloc/src/extent.c&quot;, 41, &quot;!rbtn_red_get(extent_node_t, szad_link, node)&quot;); abort(); } } while (0); do { if (__builtin_expect(!!(config_debug &amp;&amp; !(((_Bool) (((uintptr_t) (left)-&gt;szad_link.rbn_right_red) &amp; ((size_t)1))))), 0)) { je_malloc_printf( &quot;&lt;jemalloc&gt;: %s:%d: Failed assertion: \&quot;%s\&quot;\n&quot;, &quot;/home/jon/workspace/redis/deps/jemalloc/src/extent.c&quot;, 41, &quot;rbtn_red_get(extent_node_t, szad_link, left)&quot;); abort(); } } while (0); do { (left)-&gt;szad_link.rbn_right_red = (extent_node_t *) (((intptr_t) (left)-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2)); } while (0); if (pathp == path) { rbtree-&gt;rbt_root = left; } else { if (pathp[-1].cmp &lt; 0) { do { (pathp[-1].node)-&gt;szad_link.rbn_left = left; } while (0); } else { do { (pathp[-1].node)-&gt;szad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) left) | (((uintptr_t) (pathp[-1].node)-&gt;szad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); } } return; } else if (pathp == path) { rbtree-&gt;rbt_root = &amp;rbtree-&gt;rbt_nil; return; } } if (((_Bool) (((uintptr_t) (pathp-&gt;node)-&gt;szad_link.rbn_right_red) &amp; ((size_t)1)))) { do { if (__builtin_expect(!!(config_debug &amp;&amp; !(pathp[-1].cmp &lt; 0)), 0)) { je_malloc_printf( &quot;&lt;jemalloc&gt;: %s:%d: Failed assertion: \&quot;%s\&quot;\n&quot;, &quot;/home/jon/workspace/redis/deps/jemalloc/src/extent.c&quot;, 41, &quot;pathp[-1].cmp &lt; 0&quot;); abort(); } } while (0); do { (pathp[-1].node)-&gt;szad_link.rbn_left = &amp;rbtree-&gt;rbt_nil; } while (0); return; } pathp-&gt;node = &amp;rbtree-&gt;rbt_nil; for (pathp--; (uintptr_t)pathp &gt;= (uintptr_t)path; pathp--) { do { if (__builtin_expect(!!(config_debug &amp;&amp; !(pathp-&gt;cmp != 0)), 0)) { je_malloc_printf( &quot;&lt;jemalloc&gt;: %s:%d: Failed assertion: \&quot;%s\&quot;\n&quot;, &quot;/home/jon/workspace/redis/deps/jemalloc/src/extent.c&quot;, 41, &quot;pathp-&gt;cmp != 0&quot;); abort(); } } while (0); if (pathp-&gt;cmp &lt; 0) { do { (pathp-&gt;node)-&gt;szad_link.rbn_left = pathp[1].node; } while (0); do { if (__builtin_expect(!!(config_debug &amp;&amp; !(!((_Bool) (((uintptr_t) (pathp[1].node)-&gt;szad_link.rbn_right_red) &amp; ((size_t)1))))), 0)) { je_malloc_printf( &quot;&lt;jemalloc&gt;: %s:%d: Failed assertion: \&quot;%s\&quot;\n&quot;, &quot;/home/jon/workspace/redis/deps/jemalloc/src/extent.c&quot;, 41, &quot;!rbtn_red_get(extent_node_t, szad_link, pathp[1].node)&quot;); abort(); } } while (0); if (((_Bool) (((uintptr_t) (pathp-&gt;node)-&gt;szad_link.rbn_right_red) &amp; ((size_t)1)))) { extent_node_t *right = ((extent_node_t *) (((intptr_t) (pathp-&gt;node)-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2))); extent_node_t *rightleft = ((right)-&gt;szad_link.rbn_left); extent_node_t *tnode; if (((_Bool) (((uintptr_t) (rightleft)-&gt;szad_link.rbn_right_red) &amp; ((size_t)1)))) { do { (pathp-&gt;node)-&gt;szad_link.rbn_right_red = (extent_node_t *) (((intptr_t) (pathp-&gt;node)-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2)); } while (0); do { (tnode) = (((right))-&gt;szad_link.rbn_left); do { ((right))-&gt;szad_link.rbn_left = ((extent_node_t *) (((intptr_t) ((tnode))-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2))); } while (0); do { ((tnode))-&gt;szad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (right)) | (((uintptr_t) ((tnode))-&gt;szad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); } while (0); do { (pathp-&gt;node)-&gt;szad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) tnode) | (((uintptr_t) (pathp-&gt;node)-&gt;szad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); do { (tnode) = ((extent_node_t *) (((intptr_t) ((pathp-&gt;node))-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2))); do { ((pathp-&gt;node))-&gt;szad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (((tnode))-&gt;szad_link.rbn_left)) | (((uintptr_t) ((pathp-&gt;node))-&gt;szad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); do { ((tnode))-&gt;szad_link.rbn_left = (pathp-&gt;node); } while (0); } while (0); } else { do { (tnode) = ((extent_node_t *) (((intptr_t) ((pathp-&gt;node))-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2))); do { ((pathp-&gt;node))-&gt;szad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (((tnode))-&gt;szad_link.rbn_left)) | (((uintptr_t) ((pathp-&gt;node))-&gt;szad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); do { ((tnode))-&gt;szad_link.rbn_left = (pathp-&gt;node); } while (0); } while (0); } do { if (__builtin_expect(!!(config_debug &amp;&amp; !((uintptr_t)pathp &gt; (uintptr_t)path)), 0)) { je_malloc_printf( &quot;&lt;jemalloc&gt;: %s:%d: Failed assertion: \&quot;%s\&quot;\n&quot;, &quot;/home/jon/workspace/redis/deps/jemalloc/src/extent.c&quot;, 41, &quot;(uintptr_t)pathp &gt; (uintptr_t)path&quot;); abort(); } } while (0); if (pathp[-1].cmp &lt; 0) { do { (pathp[-1].node)-&gt;szad_link.rbn_left = tnode; } while (0); } else { do { (pathp[-1].node)-&gt;szad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) tnode) | (((uintptr_t) (pathp[-1].node)-&gt;szad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); } return; } else { extent_node_t *right = ((extent_node_t *) (((intptr_t) (pathp-&gt;node)-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2))); extent_node_t *rightleft = ((right)-&gt;szad_link.rbn_left); if (((_Bool) (((uintptr_t) (rightleft)-&gt;szad_link.rbn_right_red) &amp; ((size_t)1)))) { extent_node_t *tnode; do { (rightleft)-&gt;szad_link.rbn_right_red = (extent_node_t *) (((intptr_t) (rightleft)-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2)); } while (0); do { (tnode) = (((right))-&gt;szad_link.rbn_left); do { ((right))-&gt;szad_link.rbn_left = ((extent_node_t *) (((intptr_t) ((tnode))-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2))); } while (0); do { ((tnode))-&gt;szad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (right)) | (((uintptr_t) ((tnode))-&gt;szad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); } while (0); do { (pathp-&gt;node)-&gt;szad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) tnode) | (((uintptr_t) (pathp-&gt;node)-&gt;szad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); do { (tnode) = ((extent_node_t *) (((intptr_t) ((pathp-&gt;node))-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2))); do { ((pathp-&gt;node))-&gt;szad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (((tnode))-&gt;szad_link.rbn_left)) | (((uintptr_t) ((pathp-&gt;node))-&gt;szad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); do { ((tnode))-&gt;szad_link.rbn_left = (pathp-&gt;node); } while (0); } while (0); if (pathp == path) { rbtree-&gt;rbt_root = tnode; } else { if (pathp[-1].cmp &lt; 0) { do { (pathp[-1].node)-&gt;szad_link.rbn_left = tnode; } while (0); } else { do { (pathp[-1].node)-&gt;szad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) tnode) | (((uintptr_t) (pathp[-1].node)-&gt;szad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); } } return; } else { extent_node_t *tnode; do { (pathp-&gt;node)-&gt;szad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (pathp-&gt;node)-&gt;szad_link.rbn_right_red) | ((size_t)1)); } while (0); do { (tnode) = ((extent_node_t *) (((intptr_t) ((pathp-&gt;node))-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2))); do { ((pathp-&gt;node))-&gt;szad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (((tnode))-&gt;szad_link.rbn_left)) | (((uintptr_t) ((pathp-&gt;node))-&gt;szad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); do { ((tnode))-&gt;szad_link.rbn_left = (pathp-&gt;node); } while (0); } while (0); pathp-&gt;node = tnode; } } } else { extent_node_t *left; do { (pathp-&gt;node)-&gt;szad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) pathp[1].node) | (((uintptr_t) (pathp-&gt;node)-&gt;szad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); left = ((pathp-&gt;node)-&gt;szad_link.rbn_left); if (((_Bool) (((uintptr_t) (left)-&gt;szad_link.rbn_right_red) &amp; ((size_t)1)))) { extent_node_t *tnode; extent_node_t *leftright = ((extent_node_t *) (((intptr_t) (left)-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2))); extent_node_t *leftrightleft = ((leftright)-&gt;szad_link.rbn_left); if (((_Bool) (((uintptr_t) (leftrightleft)-&gt;szad_link.rbn_right_red) &amp; ((size_t)1)))) { extent_node_t *unode; do { (leftrightleft)-&gt;szad_link.rbn_right_red = (extent_node_t *) (((intptr_t) (leftrightleft)-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2)); } while (0); do { (unode) = (((pathp-&gt;node))-&gt;szad_link.rbn_left); do { ((pathp-&gt;node))-&gt;szad_link.rbn_left = ((extent_node_t *) (((intptr_t) ((unode))-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2))); } while (0); do { ((unode))-&gt;szad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (pathp-&gt;node)) | (((uintptr_t) ((unode))-&gt;szad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); } while (0); do { (tnode) = (((pathp-&gt;node))-&gt;szad_link.rbn_left); do { ((pathp-&gt;node))-&gt;szad_link.rbn_left = ((extent_node_t *) (((intptr_t) ((tnode))-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2))); } while (0); do { ((tnode))-&gt;szad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (pathp-&gt;node)) | (((uintptr_t) ((tnode))-&gt;szad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); } while (0); do { (unode)-&gt;szad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) tnode) | (((uintptr_t) (unode)-&gt;szad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); do { (tnode) = ((extent_node_t *) (((intptr_t) ((unode))-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2))); do { ((unode))-&gt;szad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (((tnode))-&gt;szad_link.rbn_left)) | (((uintptr_t) ((unode))-&gt;szad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); do { ((tnode))-&gt;szad_link.rbn_left = (unode); } while (0); } while (0); } else { do { if (__builtin_expect(!!(config_debug &amp;&amp; !(leftright != &amp;rbtree-&gt;rbt_nil)), 0)) { je_malloc_printf( &quot;&lt;jemalloc&gt;: %s:%d: Failed assertion: \&quot;%s\&quot;\n&quot;, &quot;/home/jon/workspace/redis/deps/jemalloc/src/extent.c&quot;, 41, &quot;leftright != &amp;rbtree-&gt;rbt_nil&quot;); abort(); } } while (0); do { (leftright)-&gt;szad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (leftright)-&gt;szad_link.rbn_right_red) | ((size_t)1)); } while (0); do { (tnode) = (((pathp-&gt;node))-&gt;szad_link.rbn_left); do { ((pathp-&gt;node))-&gt;szad_link.rbn_left = ((extent_node_t *) (((intptr_t) ((tnode))-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2))); } while (0); do { ((tnode))-&gt;szad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (pathp-&gt;node)) | (((uintptr_t) ((tnode))-&gt;szad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); } while (0); do { (tnode)-&gt;szad_link.rbn_right_red = (extent_node_t *) (((intptr_t) (tnode)-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2)); } while (0); } if (pathp == path) { rbtree-&gt;rbt_root = tnode; } else { if (pathp[-1].cmp &lt; 0) { do { (pathp[-1].node)-&gt;szad_link.rbn_left = tnode; } while (0); } else { do { (pathp[-1].node)-&gt;szad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) tnode) | (((uintptr_t) (pathp[-1].node)-&gt;szad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); } } return; } else if (((_Bool) (((uintptr_t) (pathp-&gt;node)-&gt;szad_link.rbn_right_red) &amp; ((size_t)1)))) { extent_node_t *leftleft = ((left)-&gt;szad_link.rbn_left); if (((_Bool) (((uintptr_t) (leftleft)-&gt;szad_link.rbn_right_red) &amp; ((size_t)1)))) { extent_node_t *tnode; do { (pathp-&gt;node)-&gt;szad_link.rbn_right_red = (extent_node_t *) (((intptr_t) (pathp-&gt;node)-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2)); } while (0); do { (left)-&gt;szad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (left)-&gt;szad_link.rbn_right_red) | ((size_t)1)); } while (0); do { (leftleft)-&gt;szad_link.rbn_right_red = (extent_node_t *) (((intptr_t) (leftleft)-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2)); } while (0); do { (tnode) = (((pathp-&gt;node))-&gt;szad_link.rbn_left); do { ((pathp-&gt;node))-&gt;szad_link.rbn_left = ((extent_node_t *) (((intptr_t) ((tnode))-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2))); } while (0); do { ((tnode))-&gt;szad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (pathp-&gt;node)) | (((uintptr_t) ((tnode))-&gt;szad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); } while (0); do { if (__builtin_expect(!!(config_debug &amp;&amp; !((uintptr_t)pathp &gt; (uintptr_t)path)), 0)) { je_malloc_printf( &quot;&lt;jemalloc&gt;: %s:%d: Failed assertion: \&quot;%s\&quot;\n&quot;, &quot;/home/jon/workspace/redis/deps/jemalloc/src/extent.c&quot;, 41, &quot;(uintptr_t)pathp &gt; (uintptr_t)path&quot;); abort(); } } while (0); if (pathp[-1].cmp &lt; 0) { do { (pathp[-1].node)-&gt;szad_link.rbn_left = tnode; } while (0); } else { do { (pathp[-1].node)-&gt;szad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) tnode) | (((uintptr_t) (pathp[-1].node)-&gt;szad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); } return; } else { do { (left)-&gt;szad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (left)-&gt;szad_link.rbn_right_red) | ((size_t)1)); } while (0); do { (pathp-&gt;node)-&gt;szad_link.rbn_right_red = (extent_node_t *) (((intptr_t) (pathp-&gt;node)-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2)); } while (0); return; } } else { extent_node_t *leftleft = ((left)-&gt;szad_link.rbn_left); if (((_Bool) (((uintptr_t) (leftleft)-&gt;szad_link.rbn_right_red) &amp; ((size_t)1)))) { extent_node_t *tnode; do { (leftleft)-&gt;szad_link.rbn_right_red = (extent_node_t *) (((intptr_t) (leftleft)-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2)); } while (0); do { (tnode) = (((pathp-&gt;node))-&gt;szad_link.rbn_left); do { ((pathp-&gt;node))-&gt;szad_link.rbn_left = ((extent_node_t *) (((intptr_t) ((tnode))-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2))); } while (0); do { ((tnode))-&gt;szad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (pathp-&gt;node)) | (((uintptr_t) ((tnode))-&gt;szad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); } while (0); if (pathp == path) { rbtree-&gt;rbt_root = tnode; } else { if (pathp[-1].cmp &lt; 0) { do { (pathp[-1].node)-&gt;szad_link.rbn_left = tnode; } while (0); } else { do { (pathp[-1].node)-&gt;szad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) tnode) | (((uintptr_t) (pathp[-1].node)-&gt;szad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); } } return; } else { do { (left)-&gt;szad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (left)-&gt;szad_link.rbn_right_red) | ((size_t)1)); } while (0); } } } } rbtree-&gt;rbt_root = path-&gt;node; do { if (__builtin_expect(!!(config_debug &amp;&amp; !(!((_Bool) (((uintptr_t) (rbtree-&gt;rbt_root)-&gt;szad_link.rbn_right_red) &amp; ((size_t)1))))), 0)) { je_malloc_printf( &quot;&lt;jemalloc&gt;: %s:%d: Failed assertion: \&quot;%s\&quot;\n&quot;, &quot;/home/jon/workspace/redis/deps/jemalloc/src/extent.c&quot;, 41, &quot;!rbtn_red_get(extent_node_t, szad_link, rbtree-&gt;rbt_root)&quot;); abort(); } } while (0); } extent_node_t * je_extent_tree_szad_iter_recurse(extent_tree_t *rbtree, extent_node_t *node, extent_node_t *(*cb)(extent_tree_t *, extent_node_t *, void *), void *arg) { if (node == &amp;rbtree-&gt;rbt_nil) { return (&amp;rbtree-&gt;rbt_nil); } else { extent_node_t *ret; if ((ret = je_extent_tree_szad_iter_recurse(rbtree, ((node)-&gt;szad_link.rbn_left), cb, arg)) != &amp;rbtree-&gt;rbt_nil || (ret = cb(rbtree, node, arg)) != ((void*)0)) { return (ret); } return ( je_extent_tree_szad_iter_recurse(rbtree, ((extent_node_t *) (((intptr_t) (node)-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2))), cb, arg)); } } extent_node_t * je_extent_tree_szad_iter_start(extent_tree_t *rbtree, extent_node_t *start, extent_node_t *node, extent_node_t *(*cb)(extent_tree_t *, extent_node_t *, void *), void *arg) { int cmp = extent_szad_comp(start, node); if (cmp &lt; 0) { extent_node_t *ret; if ((ret = je_extent_tree_szad_iter_start(rbtree, start, ((node)-&gt;szad_link.rbn_left), cb, arg)) != &amp;rbtree-&gt;rbt_nil || (ret = cb(rbtree, node, arg)) != ((void*)0)) { return (ret); } return ( je_extent_tree_szad_iter_recurse(rbtree, ((extent_node_t *) (((intptr_t) (node)-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2))), cb, arg)); } else if (cmp &gt; 0) { return ( je_extent_tree_szad_iter_start(rbtree, start, ((extent_node_t *) (((intptr_t) (node)-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2))), cb, arg)); } else { extent_node_t *ret; if ((ret = cb(rbtree, node, arg)) != ((void*)0)) { return (ret); } return ( je_extent_tree_szad_iter_recurse(rbtree, ((extent_node_t *) (((intptr_t) (node)-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2))), cb, arg)); } } extent_node_t * je_extent_tree_szad_iter(extent_tree_t *rbtree, extent_node_t *start, extent_node_t *(*cb)( extent_tree_t *, extent_node_t *, void *), void *arg) { extent_node_t *ret; if (start != ((void*)0)) { ret = je_extent_tree_szad_iter_start(rbtree, start, rbtree-&gt;rbt_root, cb, arg); } else { ret = je_extent_tree_szad_iter_recurse(rbtree, rbtree-&gt;rbt_root, cb, arg); } if (ret == &amp;rbtree-&gt;rbt_nil) { ret = ((void*)0); } return (ret); } extent_node_t * je_extent_tree_szad_reverse_iter_recurse(extent_tree_t *rbtree, extent_node_t *node, extent_node_t *(*cb)(extent_tree_t *, extent_node_t *, void *), void *arg) { if (node == &amp;rbtree-&gt;rbt_nil) { return (&amp;rbtree-&gt;rbt_nil); } else { extent_node_t *ret; if ((ret = je_extent_tree_szad_reverse_iter_recurse(rbtree, ((extent_node_t *) (((intptr_t) (node)-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2))), cb, arg)) != &amp;rbtree-&gt;rbt_nil || (ret = cb(rbtree, node, arg)) != ((void*)0)) { return (ret); } return ( je_extent_tree_szad_reverse_iter_recurse(rbtree, ((node)-&gt;szad_link.rbn_left), cb, arg)); } } extent_node_t * je_extent_tree_szad_reverse_iter_start(extent_tree_t *rbtree, extent_node_t *start, extent_node_t *node, extent_node_t *(*cb)(extent_tree_t *, extent_node_t *, void *), void *arg) { int cmp = extent_szad_comp(start, node); if (cmp &gt; 0) { extent_node_t *ret; if ((ret = je_extent_tree_szad_reverse_iter_start(rbtree, start, ((extent_node_t *) (((intptr_t) (node)-&gt;szad_link.rbn_right_red) &amp; ((ssize_t)-2))), cb, arg)) != &amp;rbtree-&gt;rbt_nil || (ret = cb(rbtree, node, arg)) != ((void*)0)) { return (ret); } return ( je_extent_tree_szad_reverse_iter_recurse(rbtree, ((node)-&gt;szad_link.rbn_left), cb, arg)); } else if (cmp &lt; 0) { return ( je_extent_tree_szad_reverse_iter_start(rbtree, start, ((node)-&gt;szad_link.rbn_left), cb, arg)); } else { extent_node_t *ret; if ((ret = cb(rbtree, node, arg)) != ((void*)0)) { return (ret); } return ( je_extent_tree_szad_reverse_iter_recurse(rbtree, ((node)-&gt;szad_link.rbn_left), cb, arg)); } } extent_node_t * je_extent_tree_szad_reverse_iter(extent_tree_t *rbtree, extent_node_t *start, extent_node_t *(*cb)(extent_tree_t *, extent_node_t *, void *), void *arg) { extent_node_t *ret; if (start != ((void*)0)) { ret = je_extent_tree_szad_reverse_iter_start(rbtree, start, rbtree-&gt;rbt_root, cb, arg); } else { ret = je_extent_tree_szad_reverse_iter_recurse(rbtree, rbtree-&gt;rbt_root, cb, arg); } if (ret == &amp;rbtree-&gt;rbt_nil) { ret = ((void*)0); } return (ret); }" data-ref="_M/rb_gen">rb_gen</a>(, extent_tree_szad_, <a class="typedef" href="../include/jemalloc/internal/extent.h.html#extent_tree_t" title='extent_tree_t' data-type='struct extent_tree_t' data-ref="extent_tree_t">extent_tree_t</a>, <a class="typedef" href="../include/jemalloc/internal/extent.h.html#extent_node_t" title='extent_node_t' data-type='struct extent_node_s' data-ref="extent_node_t">extent_node_t</a>, <a class="ref" href="../include/jemalloc/internal/extent.h.html#extent_node_s::(anonymous)::szad_link" title='extent_node_s::(anonymous union)::szad_link' data-ref="extent_node_s::(anonymous)::szad_link">szad_link</a>,</td></tr>
<tr><th id="41">41</th><td>    <a class="ref" href="#extent_szad_comp" title='extent_szad_comp' data-ref="extent_szad_comp">extent_szad_comp</a>)</td></tr>
<tr><th id="42">42</th><td></td></tr>
<tr><th id="43">43</th><td><a class="macro" href="../include/jemalloc/internal/jemalloc_internal_macros.h.html#29" title="static inline" data-ref="_M/JEMALLOC_INLINE_C">JEMALLOC_INLINE_C</a> <em>int</em></td></tr>
<tr><th id="44">44</th><td><dfn class="decl def" id="extent_ad_comp" title='extent_ad_comp' data-ref="extent_ad_comp">extent_ad_comp</dfn>(<a class="typedef" href="../include/jemalloc/internal/extent.h.html#extent_node_t" title='extent_node_t' data-type='struct extent_node_s' data-ref="extent_node_t">extent_node_t</a> *<dfn class="local col9 decl" id="9a" title='a' data-type='extent_node_t *' data-ref="9a">a</dfn>, <a class="typedef" href="../include/jemalloc/internal/extent.h.html#extent_node_t" title='extent_node_t' data-type='struct extent_node_s' data-ref="extent_node_t">extent_node_t</a> *<dfn class="local col0 decl" id="10b" title='b' data-type='extent_node_t *' data-ref="10b">b</dfn>)</td></tr>
<tr><th id="45">45</th><td>{</td></tr>
<tr><th id="46">46</th><td>	<a class="typedef" href="../../../../include/stdint.h.html#uintptr_t" title='uintptr_t' data-type='unsigned long' data-ref="uintptr_t">uintptr_t</a> <dfn class="local col1 decl" id="11a_addr" title='a_addr' data-type='uintptr_t' data-ref="11a_addr">a_addr</dfn> = (<a class="typedef" href="../../../../include/stdint.h.html#uintptr_t" title='uintptr_t' data-type='unsigned long' data-ref="uintptr_t">uintptr_t</a>)<a class="macro" href="../include/jemalloc/internal/private_namespace.h.html#189" title="je_extent_node_addr_get" data-ref="_M/extent_node_addr_get">extent_node_addr_get</a>(<a class="local col9 ref" href="#9a" title='a' data-ref="9a">a</a>);</td></tr>
<tr><th id="47">47</th><td>	<a class="typedef" href="../../../../include/stdint.h.html#uintptr_t" title='uintptr_t' data-type='unsigned long' data-ref="uintptr_t">uintptr_t</a> <dfn class="local col2 decl" id="12b_addr" title='b_addr' data-type='uintptr_t' data-ref="12b_addr">b_addr</dfn> = (<a class="typedef" href="../../../../include/stdint.h.html#uintptr_t" title='uintptr_t' data-type='unsigned long' data-ref="uintptr_t">uintptr_t</a>)<a class="macro" href="../include/jemalloc/internal/private_namespace.h.html#189" title="je_extent_node_addr_get" data-ref="_M/extent_node_addr_get">extent_node_addr_get</a>(<a class="local col0 ref" href="#10b" title='b' data-ref="10b">b</a>);</td></tr>
<tr><th id="48">48</th><td></td></tr>
<tr><th id="49">49</th><td>	<b>return</b> ((<a class="local col1 ref" href="#11a_addr" title='a_addr' data-ref="11a_addr">a_addr</a> &gt; <a class="local col2 ref" href="#12b_addr" title='b_addr' data-ref="12b_addr">b_addr</a>) - (<a class="local col1 ref" href="#11a_addr" title='a_addr' data-ref="11a_addr">a_addr</a> &lt; <a class="local col2 ref" href="#12b_addr" title='b_addr' data-ref="12b_addr">b_addr</a>));</td></tr>
<tr><th id="50">50</th><td>}</td></tr>
<tr><th id="51">51</th><td></td></tr>
<tr><th id="52">52</th><td><i>/* Generate red-black tree functions. */</i></td></tr>
<tr><th id="53">53</th><td><a class="macro" href="../include/jemalloc/internal/rb.h.html#316" title="void je_extent_tree_ad_new(extent_tree_t *rbtree) { do { (rbtree)-&gt;rbt_root = &amp;(rbtree)-&gt;rbt_nil; do { do { ((&amp;(rbtree)-&gt;rbt_nil))-&gt;ad_link.rbn_left = &amp;(rbtree)-&gt;rbt_nil; } while (0); do { ((&amp;(rbtree)-&gt;rbt_nil))-&gt;ad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) &amp;(rbtree)-&gt;rbt_nil) | (((uintptr_t) ((&amp;(rbtree)-&gt;rbt_nil))-&gt;ad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); do { ((&amp;(rbtree)-&gt;rbt_nil))-&gt;ad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) ((&amp;(rbtree)-&gt;rbt_nil))-&gt;ad_link.rbn_right_red) | ((size_t)1)); } while (0); } while (0); do { (&amp;(rbtree)-&gt;rbt_nil)-&gt;ad_link.rbn_right_red = (extent_node_t *) (((intptr_t) (&amp;(rbtree)-&gt;rbt_nil)-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2)); } while (0); } while (0); } _Bool je_extent_tree_ad_empty(extent_tree_t *rbtree) { return (rbtree-&gt;rbt_root == &amp;rbtree-&gt;rbt_nil); } extent_node_t * je_extent_tree_ad_first(extent_tree_t *rbtree) { extent_node_t *ret; do { (ret) = (rbtree-&gt;rbt_root); if ((ret) != &amp;(rbtree)-&gt;rbt_nil) { for (; (((ret))-&gt;ad_link.rbn_left) != &amp;(rbtree)-&gt;rbt_nil; (ret) = (((ret))-&gt;ad_link.rbn_left)) { } } } while (0); if (ret == &amp;rbtree-&gt;rbt_nil) { ret = ((void*)0); } return (ret); } extent_node_t * je_extent_tree_ad_last(extent_tree_t *rbtree) { extent_node_t *ret; do { (ret) = (rbtree-&gt;rbt_root); if ((ret) != &amp;(rbtree)-&gt;rbt_nil) { for (; ((extent_node_t *) (((intptr_t) ((ret))-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2))) != &amp;(rbtree)-&gt;rbt_nil; (ret) = ((extent_node_t *) (((intptr_t) ((ret))-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2)))) { } } } while (0); if (ret == &amp;rbtree-&gt;rbt_nil) { ret = ((void*)0); } return (ret); } extent_node_t * je_extent_tree_ad_next(extent_tree_t *rbtree, extent_node_t *node) { extent_node_t *ret; if (((extent_node_t *) (((intptr_t) (node)-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2))) != &amp;rbtree-&gt;rbt_nil) { do { (ret) = (((extent_node_t *) (((intptr_t) (node)-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2)))); if ((ret) != &amp;(rbtree)-&gt;rbt_nil) { for (; (((ret))-&gt;ad_link.rbn_left) != &amp;(rbtree)-&gt;rbt_nil; (ret) = (((ret))-&gt;ad_link.rbn_left)) { } } } while (0); } else { extent_node_t *tnode = rbtree-&gt;rbt_root; do { if (__builtin_expect(!!(config_debug &amp;&amp; !(tnode != &amp;rbtree-&gt;rbt_nil)), 0)) { je_malloc_printf( &quot;&lt;jemalloc&gt;: %s:%d: Failed assertion: \&quot;%s\&quot;\n&quot;, &quot;/home/jon/workspace/redis/deps/jemalloc/src/extent.c&quot;, 53, &quot;tnode != &amp;rbtree-&gt;rbt_nil&quot;); abort(); } } while (0); ret = &amp;rbtree-&gt;rbt_nil; while (1) { int cmp = (extent_ad_comp)(node, tnode); if (cmp &lt; 0) { ret = tnode; tnode = ((tnode)-&gt;ad_link.rbn_left); } else if (cmp &gt; 0) { tnode = ((extent_node_t *) (((intptr_t) (tnode)-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2))); } else { break; } do { if (__builtin_expect(!!(config_debug &amp;&amp; !(tnode != &amp;rbtree-&gt;rbt_nil)), 0)) { je_malloc_printf( &quot;&lt;jemalloc&gt;: %s:%d: Failed assertion: \&quot;%s\&quot;\n&quot;, &quot;/home/jon/workspace/redis/deps/jemalloc/src/extent.c&quot;, 53, &quot;tnode != &amp;rbtree-&gt;rbt_nil&quot;); abort(); } } while (0); } } if (ret == &amp;rbtree-&gt;rbt_nil) { ret = (((void*)0)); } return (ret); } extent_node_t * je_extent_tree_ad_prev(extent_tree_t *rbtree, extent_node_t *node) { extent_node_t *ret; if (((node)-&gt;ad_link.rbn_left) != &amp;rbtree-&gt;rbt_nil) { do { (ret) = (((node)-&gt;ad_link.rbn_left)); if ((ret) != &amp;(rbtree)-&gt;rbt_nil) { for (; ((extent_node_t *) (((intptr_t) ((ret))-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2))) != &amp;(rbtree)-&gt;rbt_nil; (ret) = ((extent_node_t *) (((intptr_t) ((ret))-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2)))) { } } } while (0); } else { extent_node_t *tnode = rbtree-&gt;rbt_root; do { if (__builtin_expect(!!(config_debug &amp;&amp; !(tnode != &amp;rbtree-&gt;rbt_nil)), 0)) { je_malloc_printf( &quot;&lt;jemalloc&gt;: %s:%d: Failed assertion: \&quot;%s\&quot;\n&quot;, &quot;/home/jon/workspace/redis/deps/jemalloc/src/extent.c&quot;, 53, &quot;tnode != &amp;rbtree-&gt;rbt_nil&quot;); abort(); } } while (0); ret = &amp;rbtree-&gt;rbt_nil; while (1) { int cmp = (extent_ad_comp)(node, tnode); if (cmp &lt; 0) { tnode = ((tnode)-&gt;ad_link.rbn_left); } else if (cmp &gt; 0) { ret = tnode; tnode = ((extent_node_t *) (((intptr_t) (tnode)-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2))); } else { break; } do { if (__builtin_expect(!!(config_debug &amp;&amp; !(tnode != &amp;rbtree-&gt;rbt_nil)), 0)) { je_malloc_printf( &quot;&lt;jemalloc&gt;: %s:%d: Failed assertion: \&quot;%s\&quot;\n&quot;, &quot;/home/jon/workspace/redis/deps/jemalloc/src/extent.c&quot;, 53, &quot;tnode != &amp;rbtree-&gt;rbt_nil&quot;); abort(); } } while (0); } } if (ret == &amp;rbtree-&gt;rbt_nil) { ret = (((void*)0)); } return (ret); } extent_node_t * je_extent_tree_ad_search(extent_tree_t *rbtree, extent_node_t *key) { extent_node_t *ret; int cmp; ret = rbtree-&gt;rbt_root; while (ret != &amp;rbtree-&gt;rbt_nil &amp;&amp; (cmp = (extent_ad_comp)(key, ret)) != 0) { if (cmp &lt; 0) { ret = ((ret)-&gt;ad_link.rbn_left); } else { ret = ((extent_node_t *) (((intptr_t) (ret)-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2))); } } if (ret == &amp;rbtree-&gt;rbt_nil) { ret = (((void*)0)); } return (ret); } extent_node_t * je_extent_tree_ad_nsearch(extent_tree_t *rbtree, extent_node_t *key) { extent_node_t *ret; extent_node_t *tnode = rbtree-&gt;rbt_root; ret = &amp;rbtree-&gt;rbt_nil; while (tnode != &amp;rbtree-&gt;rbt_nil) { int cmp = (extent_ad_comp)(key, tnode); if (cmp &lt; 0) { ret = tnode; tnode = ((tnode)-&gt;ad_link.rbn_left); } else if (cmp &gt; 0) { tnode = ((extent_node_t *) (((intptr_t) (tnode)-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2))); } else { ret = tnode; break; } } if (ret == &amp;rbtree-&gt;rbt_nil) { ret = (((void*)0)); } return (ret); } extent_node_t * je_extent_tree_ad_psearch(extent_tree_t *rbtree, extent_node_t *key) { extent_node_t *ret; extent_node_t *tnode = rbtree-&gt;rbt_root; ret = &amp;rbtree-&gt;rbt_nil; while (tnode != &amp;rbtree-&gt;rbt_nil) { int cmp = (extent_ad_comp)(key, tnode); if (cmp &lt; 0) { tnode = ((tnode)-&gt;ad_link.rbn_left); } else if (cmp &gt; 0) { ret = tnode; tnode = ((extent_node_t *) (((intptr_t) (tnode)-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2))); } else { ret = tnode; break; } } if (ret == &amp;rbtree-&gt;rbt_nil) { ret = (((void*)0)); } return (ret); } void je_extent_tree_ad_insert(extent_tree_t *rbtree, extent_node_t *node) { struct { extent_node_t *node; int cmp; } path[sizeof(void *) &lt;&lt; 4], *pathp; do { do { ((node))-&gt;ad_link.rbn_left = &amp;(rbtree)-&gt;rbt_nil; } while (0); do { ((node))-&gt;ad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) &amp;(rbtree)-&gt;rbt_nil) | (((uintptr_t) ((node))-&gt;ad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); do { ((node))-&gt;ad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) ((node))-&gt;ad_link.rbn_right_red) | ((size_t)1)); } while (0); } while (0); path-&gt;node = rbtree-&gt;rbt_root; for (pathp = path; pathp-&gt;node != &amp;rbtree-&gt;rbt_nil; pathp++) { int cmp = pathp-&gt;cmp = extent_ad_comp(node, pathp-&gt;node); do { if (__builtin_expect(!!(config_debug &amp;&amp; !(cmp != 0)), 0)) { je_malloc_printf( &quot;&lt;jemalloc&gt;: %s:%d: Failed assertion: \&quot;%s\&quot;\n&quot;, &quot;/home/jon/workspace/redis/deps/jemalloc/src/extent.c&quot;, 53, &quot;cmp != 0&quot;); abort(); } } while (0); if (cmp &lt; 0) { pathp[1].node = ((pathp-&gt;node)-&gt;ad_link.rbn_left); } else { pathp[1].node = ((extent_node_t *) (((intptr_t) (pathp-&gt;node)-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2))); } } pathp-&gt;node = node; for (pathp--; (uintptr_t)pathp &gt;= (uintptr_t)path; pathp--) { extent_node_t *cnode = pathp-&gt;node; if (pathp-&gt;cmp &lt; 0) { extent_node_t *left = pathp[1].node; do { (cnode)-&gt;ad_link.rbn_left = left; } while (0); if (((_Bool) (((uintptr_t) (left)-&gt;ad_link.rbn_right_red) &amp; ((size_t)1)))) { extent_node_t *leftleft = ((left)-&gt;ad_link.rbn_left); if (((_Bool) (((uintptr_t) (leftleft)-&gt;ad_link.rbn_right_red) &amp; ((size_t)1)))) { extent_node_t *tnode; do { (leftleft)-&gt;ad_link.rbn_right_red = (extent_node_t *) (((intptr_t) (leftleft)-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2)); } while (0); do { (tnode) = (((cnode))-&gt;ad_link.rbn_left); do { ((cnode))-&gt;ad_link.rbn_left = ((extent_node_t *) (((intptr_t) ((tnode))-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2))); } while (0); do { ((tnode))-&gt;ad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (cnode)) | (((uintptr_t) ((tnode))-&gt;ad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); } while (0); cnode = tnode; } } else { return; } } else { extent_node_t *right = pathp[1].node; do { (cnode)-&gt;ad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) right) | (((uintptr_t) (cnode)-&gt;ad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); if (((_Bool) (((uintptr_t) (right)-&gt;ad_link.rbn_right_red) &amp; ((size_t)1)))) { extent_node_t *left = ((cnode)-&gt;ad_link.rbn_left); if (((_Bool) (((uintptr_t) (left)-&gt;ad_link.rbn_right_red) &amp; ((size_t)1)))) { do { (left)-&gt;ad_link.rbn_right_red = (extent_node_t *) (((intptr_t) (left)-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2)); } while (0); do { (right)-&gt;ad_link.rbn_right_red = (extent_node_t *) (((intptr_t) (right)-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2)); } while (0); do { (cnode)-&gt;ad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (cnode)-&gt;ad_link.rbn_right_red) | ((size_t)1)); } while (0); } else { extent_node_t *tnode; _Bool tred = ((_Bool) (((uintptr_t) (cnode)-&gt;ad_link.rbn_right_red) &amp; ((size_t)1))); do { (tnode) = ((extent_node_t *) (((intptr_t) ((cnode))-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2))); do { ((cnode))-&gt;ad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (((tnode))-&gt;ad_link.rbn_left)) | (((uintptr_t) ((cnode))-&gt;ad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); do { ((tnode))-&gt;ad_link.rbn_left = (cnode); } while (0); } while (0); do { (tnode)-&gt;ad_link.rbn_right_red = (extent_node_t *) ((((intptr_t) (tnode)-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2)) | ((ssize_t)tred)); } while (0); do { (cnode)-&gt;ad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (cnode)-&gt;ad_link.rbn_right_red) | ((size_t)1)); } while (0); cnode = tnode; } } else { return; } } pathp-&gt;node = cnode; } rbtree-&gt;rbt_root = path-&gt;node; do { (rbtree-&gt;rbt_root)-&gt;ad_link.rbn_right_red = (extent_node_t *) (((intptr_t) (rbtree-&gt;rbt_root)-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2)); } while (0); } void je_extent_tree_ad_remove(extent_tree_t *rbtree, extent_node_t *node) { struct { extent_node_t *node; int cmp; } *pathp, *nodep, path[sizeof(void *) &lt;&lt; 4]; nodep = ((void*)0); path-&gt;node = rbtree-&gt;rbt_root; for (pathp = path; pathp-&gt;node != &amp;rbtree-&gt;rbt_nil; pathp++) { int cmp = pathp-&gt;cmp = extent_ad_comp(node, pathp-&gt;node); if (cmp &lt; 0) { pathp[1].node = ((pathp-&gt;node)-&gt;ad_link.rbn_left); } else { pathp[1].node = ((extent_node_t *) (((intptr_t) (pathp-&gt;node)-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2))); if (cmp == 0) { pathp-&gt;cmp = 1; nodep = pathp; for (pathp++; pathp-&gt;node != &amp;rbtree-&gt;rbt_nil; pathp++) { pathp-&gt;cmp = -1; pathp[1].node = ((pathp-&gt;node)-&gt;ad_link.rbn_left); } break; } } } do { if (__builtin_expect(!!(config_debug &amp;&amp; !(nodep-&gt;node == node)), 0)) { je_malloc_printf( &quot;&lt;jemalloc&gt;: %s:%d: Failed assertion: \&quot;%s\&quot;\n&quot;, &quot;/home/jon/workspace/redis/deps/jemalloc/src/extent.c&quot;, 53, &quot;nodep-&gt;node == node&quot;); abort(); } } while (0); pathp--; if (pathp-&gt;node != node) { _Bool tred = ((_Bool) (((uintptr_t) (pathp-&gt;node)-&gt;ad_link.rbn_right_red) &amp; ((size_t)1))); do { (pathp-&gt;node)-&gt;ad_link.rbn_right_red = (extent_node_t *) ((((intptr_t) (pathp-&gt;node)-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2)) | ((ssize_t)((_Bool) (((uintptr_t) (node)-&gt;ad_link.rbn_right_red) &amp; ((size_t)1))))); } while (0); do { (pathp-&gt;node)-&gt;ad_link.rbn_left = ((node)-&gt;ad_link.rbn_left); } while (0); do { (pathp-&gt;node)-&gt;ad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) ((extent_node_t *) (((intptr_t) (node)-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2)))) | (((uintptr_t) (pathp-&gt;node)-&gt;ad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); do { (node)-&gt;ad_link.rbn_right_red = (extent_node_t *) ((((intptr_t) (node)-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2)) | ((ssize_t)tred)); } while (0); nodep-&gt;node = pathp-&gt;node; pathp-&gt;node = node; if (nodep == path) { rbtree-&gt;rbt_root = nodep-&gt;node; } else { if (nodep[-1].cmp &lt; 0) { do { (nodep[-1].node)-&gt;ad_link.rbn_left = nodep-&gt;node; } while (0); } else { do { (nodep[-1].node)-&gt;ad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) nodep-&gt;node) | (((uintptr_t) (nodep[-1].node)-&gt;ad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); } } } else { extent_node_t *left = ((node)-&gt;ad_link.rbn_left); if (left != &amp;rbtree-&gt;rbt_nil) { do { if (__builtin_expect(!!(config_debug &amp;&amp; !(!((_Bool) (((uintptr_t) (node)-&gt;ad_link.rbn_right_red) &amp; ((size_t)1))))), 0)) { je_malloc_printf( &quot;&lt;jemalloc&gt;: %s:%d: Failed assertion: \&quot;%s\&quot;\n&quot;, &quot;/home/jon/workspace/redis/deps/jemalloc/src/extent.c&quot;, 53, &quot;!rbtn_red_get(extent_node_t, ad_link, node)&quot;); abort(); } } while (0); do { if (__builtin_expect(!!(config_debug &amp;&amp; !(((_Bool) (((uintptr_t) (left)-&gt;ad_link.rbn_right_red) &amp; ((size_t)1))))), 0)) { je_malloc_printf( &quot;&lt;jemalloc&gt;: %s:%d: Failed assertion: \&quot;%s\&quot;\n&quot;, &quot;/home/jon/workspace/redis/deps/jemalloc/src/extent.c&quot;, 53, &quot;rbtn_red_get(extent_node_t, ad_link, left)&quot;); abort(); } } while (0); do { (left)-&gt;ad_link.rbn_right_red = (extent_node_t *) (((intptr_t) (left)-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2)); } while (0); if (pathp == path) { rbtree-&gt;rbt_root = left; } else { if (pathp[-1].cmp &lt; 0) { do { (pathp[-1].node)-&gt;ad_link.rbn_left = left; } while (0); } else { do { (pathp[-1].node)-&gt;ad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) left) | (((uintptr_t) (pathp[-1].node)-&gt;ad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); } } return; } else if (pathp == path) { rbtree-&gt;rbt_root = &amp;rbtree-&gt;rbt_nil; return; } } if (((_Bool) (((uintptr_t) (pathp-&gt;node)-&gt;ad_link.rbn_right_red) &amp; ((size_t)1)))) { do { if (__builtin_expect(!!(config_debug &amp;&amp; !(pathp[-1].cmp &lt; 0)), 0)) { je_malloc_printf( &quot;&lt;jemalloc&gt;: %s:%d: Failed assertion: \&quot;%s\&quot;\n&quot;, &quot;/home/jon/workspace/redis/deps/jemalloc/src/extent.c&quot;, 53, &quot;pathp[-1].cmp &lt; 0&quot;); abort(); } } while (0); do { (pathp[-1].node)-&gt;ad_link.rbn_left = &amp;rbtree-&gt;rbt_nil; } while (0); return; } pathp-&gt;node = &amp;rbtree-&gt;rbt_nil; for (pathp--; (uintptr_t)pathp &gt;= (uintptr_t)path; pathp--) { do { if (__builtin_expect(!!(config_debug &amp;&amp; !(pathp-&gt;cmp != 0)), 0)) { je_malloc_printf( &quot;&lt;jemalloc&gt;: %s:%d: Failed assertion: \&quot;%s\&quot;\n&quot;, &quot;/home/jon/workspace/redis/deps/jemalloc/src/extent.c&quot;, 53, &quot;pathp-&gt;cmp != 0&quot;); abort(); } } while (0); if (pathp-&gt;cmp &lt; 0) { do { (pathp-&gt;node)-&gt;ad_link.rbn_left = pathp[1].node; } while (0); do { if (__builtin_expect(!!(config_debug &amp;&amp; !(!((_Bool) (((uintptr_t) (pathp[1].node)-&gt;ad_link.rbn_right_red) &amp; ((size_t)1))))), 0)) { je_malloc_printf( &quot;&lt;jemalloc&gt;: %s:%d: Failed assertion: \&quot;%s\&quot;\n&quot;, &quot;/home/jon/workspace/redis/deps/jemalloc/src/extent.c&quot;, 53, &quot;!rbtn_red_get(extent_node_t, ad_link, pathp[1].node)&quot;); abort(); } } while (0); if (((_Bool) (((uintptr_t) (pathp-&gt;node)-&gt;ad_link.rbn_right_red) &amp; ((size_t)1)))) { extent_node_t *right = ((extent_node_t *) (((intptr_t) (pathp-&gt;node)-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2))); extent_node_t *rightleft = ((right)-&gt;ad_link.rbn_left); extent_node_t *tnode; if (((_Bool) (((uintptr_t) (rightleft)-&gt;ad_link.rbn_right_red) &amp; ((size_t)1)))) { do { (pathp-&gt;node)-&gt;ad_link.rbn_right_red = (extent_node_t *) (((intptr_t) (pathp-&gt;node)-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2)); } while (0); do { (tnode) = (((right))-&gt;ad_link.rbn_left); do { ((right))-&gt;ad_link.rbn_left = ((extent_node_t *) (((intptr_t) ((tnode))-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2))); } while (0); do { ((tnode))-&gt;ad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (right)) | (((uintptr_t) ((tnode))-&gt;ad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); } while (0); do { (pathp-&gt;node)-&gt;ad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) tnode) | (((uintptr_t) (pathp-&gt;node)-&gt;ad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); do { (tnode) = ((extent_node_t *) (((intptr_t) ((pathp-&gt;node))-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2))); do { ((pathp-&gt;node))-&gt;ad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (((tnode))-&gt;ad_link.rbn_left)) | (((uintptr_t) ((pathp-&gt;node))-&gt;ad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); do { ((tnode))-&gt;ad_link.rbn_left = (pathp-&gt;node); } while (0); } while (0); } else { do { (tnode) = ((extent_node_t *) (((intptr_t) ((pathp-&gt;node))-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2))); do { ((pathp-&gt;node))-&gt;ad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (((tnode))-&gt;ad_link.rbn_left)) | (((uintptr_t) ((pathp-&gt;node))-&gt;ad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); do { ((tnode))-&gt;ad_link.rbn_left = (pathp-&gt;node); } while (0); } while (0); } do { if (__builtin_expect(!!(config_debug &amp;&amp; !((uintptr_t)pathp &gt; (uintptr_t)path)), 0)) { je_malloc_printf( &quot;&lt;jemalloc&gt;: %s:%d: Failed assertion: \&quot;%s\&quot;\n&quot;, &quot;/home/jon/workspace/redis/deps/jemalloc/src/extent.c&quot;, 53, &quot;(uintptr_t)pathp &gt; (uintptr_t)path&quot;); abort(); } } while (0); if (pathp[-1].cmp &lt; 0) { do { (pathp[-1].node)-&gt;ad_link.rbn_left = tnode; } while (0); } else { do { (pathp[-1].node)-&gt;ad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) tnode) | (((uintptr_t) (pathp[-1].node)-&gt;ad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); } return; } else { extent_node_t *right = ((extent_node_t *) (((intptr_t) (pathp-&gt;node)-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2))); extent_node_t *rightleft = ((right)-&gt;ad_link.rbn_left); if (((_Bool) (((uintptr_t) (rightleft)-&gt;ad_link.rbn_right_red) &amp; ((size_t)1)))) { extent_node_t *tnode; do { (rightleft)-&gt;ad_link.rbn_right_red = (extent_node_t *) (((intptr_t) (rightleft)-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2)); } while (0); do { (tnode) = (((right))-&gt;ad_link.rbn_left); do { ((right))-&gt;ad_link.rbn_left = ((extent_node_t *) (((intptr_t) ((tnode))-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2))); } while (0); do { ((tnode))-&gt;ad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (right)) | (((uintptr_t) ((tnode))-&gt;ad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); } while (0); do { (pathp-&gt;node)-&gt;ad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) tnode) | (((uintptr_t) (pathp-&gt;node)-&gt;ad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); do { (tnode) = ((extent_node_t *) (((intptr_t) ((pathp-&gt;node))-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2))); do { ((pathp-&gt;node))-&gt;ad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (((tnode))-&gt;ad_link.rbn_left)) | (((uintptr_t) ((pathp-&gt;node))-&gt;ad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); do { ((tnode))-&gt;ad_link.rbn_left = (pathp-&gt;node); } while (0); } while (0); if (pathp == path) { rbtree-&gt;rbt_root = tnode; } else { if (pathp[-1].cmp &lt; 0) { do { (pathp[-1].node)-&gt;ad_link.rbn_left = tnode; } while (0); } else { do { (pathp[-1].node)-&gt;ad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) tnode) | (((uintptr_t) (pathp[-1].node)-&gt;ad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); } } return; } else { extent_node_t *tnode; do { (pathp-&gt;node)-&gt;ad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (pathp-&gt;node)-&gt;ad_link.rbn_right_red) | ((size_t)1)); } while (0); do { (tnode) = ((extent_node_t *) (((intptr_t) ((pathp-&gt;node))-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2))); do { ((pathp-&gt;node))-&gt;ad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (((tnode))-&gt;ad_link.rbn_left)) | (((uintptr_t) ((pathp-&gt;node))-&gt;ad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); do { ((tnode))-&gt;ad_link.rbn_left = (pathp-&gt;node); } while (0); } while (0); pathp-&gt;node = tnode; } } } else { extent_node_t *left; do { (pathp-&gt;node)-&gt;ad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) pathp[1].node) | (((uintptr_t) (pathp-&gt;node)-&gt;ad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); left = ((pathp-&gt;node)-&gt;ad_link.rbn_left); if (((_Bool) (((uintptr_t) (left)-&gt;ad_link.rbn_right_red) &amp; ((size_t)1)))) { extent_node_t *tnode; extent_node_t *leftright = ((extent_node_t *) (((intptr_t) (left)-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2))); extent_node_t *leftrightleft = ((leftright)-&gt;ad_link.rbn_left); if (((_Bool) (((uintptr_t) (leftrightleft)-&gt;ad_link.rbn_right_red) &amp; ((size_t)1)))) { extent_node_t *unode; do { (leftrightleft)-&gt;ad_link.rbn_right_red = (extent_node_t *) (((intptr_t) (leftrightleft)-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2)); } while (0); do { (unode) = (((pathp-&gt;node))-&gt;ad_link.rbn_left); do { ((pathp-&gt;node))-&gt;ad_link.rbn_left = ((extent_node_t *) (((intptr_t) ((unode))-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2))); } while (0); do { ((unode))-&gt;ad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (pathp-&gt;node)) | (((uintptr_t) ((unode))-&gt;ad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); } while (0); do { (tnode) = (((pathp-&gt;node))-&gt;ad_link.rbn_left); do { ((pathp-&gt;node))-&gt;ad_link.rbn_left = ((extent_node_t *) (((intptr_t) ((tnode))-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2))); } while (0); do { ((tnode))-&gt;ad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (pathp-&gt;node)) | (((uintptr_t) ((tnode))-&gt;ad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); } while (0); do { (unode)-&gt;ad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) tnode) | (((uintptr_t) (unode)-&gt;ad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); do { (tnode) = ((extent_node_t *) (((intptr_t) ((unode))-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2))); do { ((unode))-&gt;ad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (((tnode))-&gt;ad_link.rbn_left)) | (((uintptr_t) ((unode))-&gt;ad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); do { ((tnode))-&gt;ad_link.rbn_left = (unode); } while (0); } while (0); } else { do { if (__builtin_expect(!!(config_debug &amp;&amp; !(leftright != &amp;rbtree-&gt;rbt_nil)), 0)) { je_malloc_printf( &quot;&lt;jemalloc&gt;: %s:%d: Failed assertion: \&quot;%s\&quot;\n&quot;, &quot;/home/jon/workspace/redis/deps/jemalloc/src/extent.c&quot;, 53, &quot;leftright != &amp;rbtree-&gt;rbt_nil&quot;); abort(); } } while (0); do { (leftright)-&gt;ad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (leftright)-&gt;ad_link.rbn_right_red) | ((size_t)1)); } while (0); do { (tnode) = (((pathp-&gt;node))-&gt;ad_link.rbn_left); do { ((pathp-&gt;node))-&gt;ad_link.rbn_left = ((extent_node_t *) (((intptr_t) ((tnode))-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2))); } while (0); do { ((tnode))-&gt;ad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (pathp-&gt;node)) | (((uintptr_t) ((tnode))-&gt;ad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); } while (0); do { (tnode)-&gt;ad_link.rbn_right_red = (extent_node_t *) (((intptr_t) (tnode)-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2)); } while (0); } if (pathp == path) { rbtree-&gt;rbt_root = tnode; } else { if (pathp[-1].cmp &lt; 0) { do { (pathp[-1].node)-&gt;ad_link.rbn_left = tnode; } while (0); } else { do { (pathp[-1].node)-&gt;ad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) tnode) | (((uintptr_t) (pathp[-1].node)-&gt;ad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); } } return; } else if (((_Bool) (((uintptr_t) (pathp-&gt;node)-&gt;ad_link.rbn_right_red) &amp; ((size_t)1)))) { extent_node_t *leftleft = ((left)-&gt;ad_link.rbn_left); if (((_Bool) (((uintptr_t) (leftleft)-&gt;ad_link.rbn_right_red) &amp; ((size_t)1)))) { extent_node_t *tnode; do { (pathp-&gt;node)-&gt;ad_link.rbn_right_red = (extent_node_t *) (((intptr_t) (pathp-&gt;node)-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2)); } while (0); do { (left)-&gt;ad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (left)-&gt;ad_link.rbn_right_red) | ((size_t)1)); } while (0); do { (leftleft)-&gt;ad_link.rbn_right_red = (extent_node_t *) (((intptr_t) (leftleft)-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2)); } while (0); do { (tnode) = (((pathp-&gt;node))-&gt;ad_link.rbn_left); do { ((pathp-&gt;node))-&gt;ad_link.rbn_left = ((extent_node_t *) (((intptr_t) ((tnode))-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2))); } while (0); do { ((tnode))-&gt;ad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (pathp-&gt;node)) | (((uintptr_t) ((tnode))-&gt;ad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); } while (0); do { if (__builtin_expect(!!(config_debug &amp;&amp; !((uintptr_t)pathp &gt; (uintptr_t)path)), 0)) { je_malloc_printf( &quot;&lt;jemalloc&gt;: %s:%d: Failed assertion: \&quot;%s\&quot;\n&quot;, &quot;/home/jon/workspace/redis/deps/jemalloc/src/extent.c&quot;, 53, &quot;(uintptr_t)pathp &gt; (uintptr_t)path&quot;); abort(); } } while (0); if (pathp[-1].cmp &lt; 0) { do { (pathp[-1].node)-&gt;ad_link.rbn_left = tnode; } while (0); } else { do { (pathp[-1].node)-&gt;ad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) tnode) | (((uintptr_t) (pathp[-1].node)-&gt;ad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); } return; } else { do { (left)-&gt;ad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (left)-&gt;ad_link.rbn_right_red) | ((size_t)1)); } while (0); do { (pathp-&gt;node)-&gt;ad_link.rbn_right_red = (extent_node_t *) (((intptr_t) (pathp-&gt;node)-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2)); } while (0); return; } } else { extent_node_t *leftleft = ((left)-&gt;ad_link.rbn_left); if (((_Bool) (((uintptr_t) (leftleft)-&gt;ad_link.rbn_right_red) &amp; ((size_t)1)))) { extent_node_t *tnode; do { (leftleft)-&gt;ad_link.rbn_right_red = (extent_node_t *) (((intptr_t) (leftleft)-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2)); } while (0); do { (tnode) = (((pathp-&gt;node))-&gt;ad_link.rbn_left); do { ((pathp-&gt;node))-&gt;ad_link.rbn_left = ((extent_node_t *) (((intptr_t) ((tnode))-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2))); } while (0); do { ((tnode))-&gt;ad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (pathp-&gt;node)) | (((uintptr_t) ((tnode))-&gt;ad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); } while (0); if (pathp == path) { rbtree-&gt;rbt_root = tnode; } else { if (pathp[-1].cmp &lt; 0) { do { (pathp[-1].node)-&gt;ad_link.rbn_left = tnode; } while (0); } else { do { (pathp[-1].node)-&gt;ad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) tnode) | (((uintptr_t) (pathp[-1].node)-&gt;ad_link.rbn_right_red) &amp; ((size_t)1))); } while (0); } } return; } else { do { (left)-&gt;ad_link.rbn_right_red = (extent_node_t *) (((uintptr_t) (left)-&gt;ad_link.rbn_right_red) | ((size_t)1)); } while (0); } } } } rbtree-&gt;rbt_root = path-&gt;node; do { if (__builtin_expect(!!(config_debug &amp;&amp; !(!((_Bool) (((uintptr_t) (rbtree-&gt;rbt_root)-&gt;ad_link.rbn_right_red) &amp; ((size_t)1))))), 0)) { je_malloc_printf( &quot;&lt;jemalloc&gt;: %s:%d: Failed assertion: \&quot;%s\&quot;\n&quot;, &quot;/home/jon/workspace/redis/deps/jemalloc/src/extent.c&quot;, 53, &quot;!rbtn_red_get(extent_node_t, ad_link, rbtree-&gt;rbt_root)&quot;); abort(); } } while (0); } extent_node_t * je_extent_tree_ad_iter_recurse(extent_tree_t *rbtree, extent_node_t *node, extent_node_t *(*cb)(extent_tree_t *, extent_node_t *, void *), void *arg) { if (node == &amp;rbtree-&gt;rbt_nil) { return (&amp;rbtree-&gt;rbt_nil); } else { extent_node_t *ret; if ((ret = je_extent_tree_ad_iter_recurse(rbtree, ((node)-&gt;ad_link.rbn_left), cb, arg)) != &amp;rbtree-&gt;rbt_nil || (ret = cb(rbtree, node, arg)) != ((void*)0)) { return (ret); } return ( je_extent_tree_ad_iter_recurse(rbtree, ((extent_node_t *) (((intptr_t) (node)-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2))), cb, arg)); } } extent_node_t * je_extent_tree_ad_iter_start(extent_tree_t *rbtree, extent_node_t *start, extent_node_t *node, extent_node_t *(*cb)(extent_tree_t *, extent_node_t *, void *), void *arg) { int cmp = extent_ad_comp(start, node); if (cmp &lt; 0) { extent_node_t *ret; if ((ret = je_extent_tree_ad_iter_start(rbtree, start, ((node)-&gt;ad_link.rbn_left), cb, arg)) != &amp;rbtree-&gt;rbt_nil || (ret = cb(rbtree, node, arg)) != ((void*)0)) { return (ret); } return ( je_extent_tree_ad_iter_recurse(rbtree, ((extent_node_t *) (((intptr_t) (node)-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2))), cb, arg)); } else if (cmp &gt; 0) { return ( je_extent_tree_ad_iter_start(rbtree, start, ((extent_node_t *) (((intptr_t) (node)-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2))), cb, arg)); } else { extent_node_t *ret; if ((ret = cb(rbtree, node, arg)) != ((void*)0)) { return (ret); } return ( je_extent_tree_ad_iter_recurse(rbtree, ((extent_node_t *) (((intptr_t) (node)-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2))), cb, arg)); } } extent_node_t * je_extent_tree_ad_iter(extent_tree_t *rbtree, extent_node_t *start, extent_node_t *(*cb)( extent_tree_t *, extent_node_t *, void *), void *arg) { extent_node_t *ret; if (start != ((void*)0)) { ret = je_extent_tree_ad_iter_start(rbtree, start, rbtree-&gt;rbt_root, cb, arg); } else { ret = je_extent_tree_ad_iter_recurse(rbtree, rbtree-&gt;rbt_root, cb, arg); } if (ret == &amp;rbtree-&gt;rbt_nil) { ret = ((void*)0); } return (ret); } extent_node_t * je_extent_tree_ad_reverse_iter_recurse(extent_tree_t *rbtree, extent_node_t *node, extent_node_t *(*cb)(extent_tree_t *, extent_node_t *, void *), void *arg) { if (node == &amp;rbtree-&gt;rbt_nil) { return (&amp;rbtree-&gt;rbt_nil); } else { extent_node_t *ret; if ((ret = je_extent_tree_ad_reverse_iter_recurse(rbtree, ((extent_node_t *) (((intptr_t) (node)-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2))), cb, arg)) != &amp;rbtree-&gt;rbt_nil || (ret = cb(rbtree, node, arg)) != ((void*)0)) { return (ret); } return ( je_extent_tree_ad_reverse_iter_recurse(rbtree, ((node)-&gt;ad_link.rbn_left), cb, arg)); } } extent_node_t * je_extent_tree_ad_reverse_iter_start(extent_tree_t *rbtree, extent_node_t *start, extent_node_t *node, extent_node_t *(*cb)(extent_tree_t *, extent_node_t *, void *), void *arg) { int cmp = extent_ad_comp(start, node); if (cmp &gt; 0) { extent_node_t *ret; if ((ret = je_extent_tree_ad_reverse_iter_start(rbtree, start, ((extent_node_t *) (((intptr_t) (node)-&gt;ad_link.rbn_right_red) &amp; ((ssize_t)-2))), cb, arg)) != &amp;rbtree-&gt;rbt_nil || (ret = cb(rbtree, node, arg)) != ((void*)0)) { return (ret); } return ( je_extent_tree_ad_reverse_iter_recurse(rbtree, ((node)-&gt;ad_link.rbn_left), cb, arg)); } else if (cmp &lt; 0) { return ( je_extent_tree_ad_reverse_iter_start(rbtree, start, ((node)-&gt;ad_link.rbn_left), cb, arg)); } else { extent_node_t *ret; if ((ret = cb(rbtree, node, arg)) != ((void*)0)) { return (ret); } return ( je_extent_tree_ad_reverse_iter_recurse(rbtree, ((node)-&gt;ad_link.rbn_left), cb, arg)); } } extent_node_t * je_extent_tree_ad_reverse_iter(extent_tree_t *rbtree, extent_node_t *start, extent_node_t *(*cb)(extent_tree_t *, extent_node_t *, void *), void *arg) { extent_node_t *ret; if (start != ((void*)0)) { ret = je_extent_tree_ad_reverse_iter_start(rbtree, start, rbtree-&gt;rbt_root, cb, arg); } else { ret = je_extent_tree_ad_reverse_iter_recurse(rbtree, rbtree-&gt;rbt_root, cb, arg); } if (ret == &amp;rbtree-&gt;rbt_nil) { ret = ((void*)0); } return (ret); }" data-ref="_M/rb_gen">rb_gen</a>(, extent_tree_ad_, <a class="typedef" href="../include/jemalloc/internal/extent.h.html#extent_tree_t" title='extent_tree_t' data-type='struct extent_tree_t' data-ref="extent_tree_t">extent_tree_t</a>, <a class="typedef" href="../include/jemalloc/internal/extent.h.html#extent_node_t" title='extent_node_t' data-type='struct extent_node_s' data-ref="extent_node_t">extent_node_t</a>, <a class="ref" href="../include/jemalloc/internal/extent.h.html#extent_node_s::ad_link" title='extent_node_s::ad_link' data-ref="extent_node_s::ad_link">ad_link</a>, <a class="ref" href="#extent_ad_comp" title='extent_ad_comp' data-ref="extent_ad_comp">extent_ad_comp</a>)</td></tr>
<tr><th id="54">54</th><td></td></tr>
</table><hr/><p id='footer'>
Generated on <em>2017-Oct-16</em> from project codebrowser revision <em>with-deprecated-diskstore-4466-g2bf8c2c</em><br />Powered by <a href='https://woboq.com'><img alt='Woboq' src='https://code.woboq.org/woboq-16.png' width='41' height='16' /></a> <a href='https://code.woboq.org'>Code Browser</a> 2.1
<br/>Generator usage only permitted with license.</p>
</div></body></html>
